<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>The Cox Proportional Hazards model | MA50262: Evaluation of Methods to Accommodate Non-Proportional Hazards in the Analysis of Clinical Trials</title>
  <meta name="description" content="The Cox Proportional Hazards model | MA50262: Evaluation of Methods to Accommodate Non-Proportional Hazards in the Analysis of Clinical Trials" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="The Cox Proportional Hazards model | MA50262: Evaluation of Methods to Accommodate Non-Proportional Hazards in the Analysis of Clinical Trials" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="The Cox Proportional Hazards model | MA50262: Evaluation of Methods to Accommodate Non-Proportional Hazards in the Analysis of Clinical Trials" />
  
  
  

<meta name="author" content="Martin Adrian Hewing" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="1-section-rmd-basics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminary Content</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-preface"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-dedication"><i class="fa fa-check"></i>Dedication</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-abstract"><i class="fa fa-check"></i>Abstract</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="section-the-cox-proportional-hazards-model.html"><a href="section-the-cox-proportional-hazards-model.html"><i class="fa fa-check"></i>The Cox Proportional Hazards model</a></li>
<li class="chapter" data-level="1" data-path="1-section-rmd-basics.html"><a href="1-section-rmd-basics.html"><i class="fa fa-check"></i><b>1</b> Literature Review</a></li>
<li class="chapter" data-level="2" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html"><i class="fa fa-check"></i><b>2</b> Reconstructing Data Based on the Guyot et al. 2016 Algorithm</a><ul>
<li class="chapter" data-level="2.1" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html#section-r-shiny-app-to-visualise-km-curves-and-a-summary-of-the-data."><i class="fa fa-check"></i><b>2.1</b> R Shiny App to Visualise KM Curves and a Summary of the Data.</a></li>
<li class="chapter" data-level="2.2" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html#section-math"><i class="fa fa-check"></i><b>2.2</b> Math</a></li>
<li class="chapter" data-level="2.3" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html#section-chemistry-101-symbols"><i class="fa fa-check"></i><b>2.3</b> Chemistry 101: Symbols</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html#section-typesetting-reactions"><i class="fa fa-check"></i><b>2.3.1</b> Typesetting reactions</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html#section-other-examples-of-reactions"><i class="fa fa-check"></i><b>2.3.2</b> Other examples of reactions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html#section-physics"><i class="fa fa-check"></i><b>2.4</b> Physics</a></li>
<li class="chapter" data-level="2.5" data-path="2-section-math-sci.html"><a href="2-section-math-sci.html#section-biology"><i class="fa fa-check"></i><b>2.5</b> Biology</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-section-ref-labels.html"><a href="3-section-ref-labels.html"><i class="fa fa-check"></i><b>3</b> Tables, Graphics, References, and Labels</a><ul>
<li class="chapter" data-level="3.1" data-path="3-section-ref-labels.html"><a href="3-section-ref-labels.html#section-tables"><i class="fa fa-check"></i><b>3.1</b> Tables</a></li>
<li class="chapter" data-level="3.2" data-path="3-section-ref-labels.html"><a href="3-section-ref-labels.html#section-figures"><i class="fa fa-check"></i><b>3.2</b> Figures</a></li>
<li class="chapter" data-level="3.3" data-path="3-section-ref-labels.html"><a href="3-section-ref-labels.html#section-footnotes-and-endnotes"><i class="fa fa-check"></i><b>3.3</b> Footnotes and Endnotes</a></li>
<li class="chapter" data-level="3.4" data-path="3-section-ref-labels.html"><a href="3-section-ref-labels.html#section-bibliographies"><i class="fa fa-check"></i><b>3.4</b> Bibliographies</a></li>
<li class="chapter" data-level="3.5" data-path="3-section-ref-labels.html"><a href="3-section-ref-labels.html#section-anything-else"><i class="fa fa-check"></i><b>3.5</b> Anything else?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="section-conclusion.html"><a href="section-conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-section-the-first-appendix.html"><a href="A-section-the-first-appendix.html"><i class="fa fa-check"></i><b>A</b> The First Appendix</a></li>
<li class="chapter" data-level="B" data-path="B-section-the-second-appendix-for-fun.html"><a href="B-section-the-second-appendix-for-fun.html"><i class="fa fa-check"></i><b>B</b> The Second Appendix, for Fun</a></li>
<li class="chapter" data-level="" data-path="section-references.html"><a href="section-references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MA50262: Evaluation of Methods to Accommodate Non-Proportional Hazards in the Analysis of Clinical Trials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-the-cox-proportional-hazards-model" class="section level1 unnumbered">
<h1>The Cox Proportional Hazards model</h1>
<p>This paper will now proceed to give a concise outline of censoring, the hazard function, the Cox model and some of the most important characteristics of this particular approach.
<br/><br/>
Censoring happens when some information about the survival times of individuals is available, but it is not known precisely. In general there are three separate answers to why censoring is likely to occur. Firstly, the individual does not get the event before the end of the study. Secondly, in the course of the study period, an individual is lost to follow-up, and thirdly, because an individual withdraws from the study, but for a reason other than due to getting the event of interest.
<br/><br/>
Additionally, there are three types of censoring that can happen. Firstly, data that is right-censored. In this case the true time survived is the same as or more than the recorded survival time. Secondly, data that is left-censored. In this case the true time survived is the same as or less than the recorded survival time. Thirdly, data that is interval-censored. In this case the true time survived is within a time interval which is known to the researcher. This project will focus on data that is right censored.
<br/><br/>
The hazard function(also known as the conditional failure rate) is given by:</p>
<p><br/><br/></p>
<p><span class="math display">\[h(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t \leq T&lt;t+\Delta t | T \geq t)}{\Delta t}\]</span></p>
<p><br/><br/></p>
<p>An explanation of the various components of the hazard function are as follows: <span class="math inline">\(\mathit{h(t)}\)</span> is equal to the limit as <span class="math inline">\(\mathit\Delta t\)</span> (gives instantaneous potential) gets closer to zero of the probability that an individual gets the event in the time interval <span class="math inline">\([t, t+\Delta t]\)</span> given the individual has already survived up to time <span class="math inline">\(\textit{t}\)</span> divided by a small change in <span class="math inline">\(\textit{t}\)</span>, noting that, <span class="math inline">\(\mathit{h(t)}\)</span> is not a probability as <span class="math inline">\(\textit{P}\)</span> has been divided by <span class="math inline">\(\mathit\Delta t\)</span>.
<br/><br/>
Formally <span class="math inline">\(\mathit{h(t)}\)</span> can be defined as a function that “gives the instantaneous potential per unit time for the event to occur, given that the individual has survived up to time <span class="math inline">\(\textit{t}\)</span>”. Alternatively, <span class="math inline">\(\mathit{h(t)}\)</span> can be thought of as like a speedometer. This device gives drivers information on their current velocity, for example a car travelling at 60 miles per hour, has the potential to cover 60 miles in the next hour. However, because the vehicle might accelerate or decelerate in that time period, at that moment when 60 MPH was observed, the speed reading does not show how many miles the car will actually cover, it just gives drivers velocity or instantaneous potential at that moment (this is assuming that it is given the driver has already driven some distance).
<br/><br/>
In a similar fashion the hazard function calculates the potential to get the event being studied at that instant, given survival up to that point in time. Furthermore, it is important to note that for specific <span class="math inline">\(\textit{t}\)</span> time values the hazard function has two properties: firstly, <span class="math inline">\(\mathit{h(t)}\)</span> is not limited to an upper bound value. Secondly, <span class="math inline">\(\mathit{h(t)}\)</span> is never negative, it is more than or equal to zero.
<br/><br/>
The Cox proportional hazards regression model formula is given by:</p>
<p><br/><br/></p>
<p><span class="math display">\[h(t, \mathbf{X})=h_{0}(t) e^{\sum_{i=1}^{p} \beta_{i} X_{i}}\]</span></p>
<p><br/><br/></p>
<p><span class="math display">\[\mathbf{X}=\left(X_{1}, X_{2}, \dots, X_{p}\right)\]</span></p>
<p><br/><br/></p>
<p>The left hand side of the above expression is the time <span class="math inline">\(\textit{t}\)</span> hazard that an individual faces given a collection of explanatory variables <span class="math inline">\(\mathbf{X}\)</span> whereas, the right hand side of (2) is the product of the baseline hazard function given by <span class="math inline">\(\mathit{{h_{0}(t)}}\)</span> and an exponential expression which is raised to the <span class="math inline">\(\mathit{\beta_{i} X_{i}}\)</span> summed over the <span class="math inline">\(\textit{P}\)</span> predictor <span class="math inline">\(\mathit{X}\)</span> variables.
<br/><br/>
Additionally in regard to the proportional hazards assumption it is important to note that in the formula given in (2) the baseline hazard is a function of <span class="math inline">\(\textit{t}\)</span> but not the <span class="math inline">\(X^{\prime} s\)</span>. Conversely, the exponential expression does not involve the <span class="math inline">\(\textit{t&#39;s}\)</span>, but does involve the <span class="math inline">\(X^{\prime} s\)</span>. Therefore, the <span class="math inline">\(X^{\prime} s\)</span> are “time-independent” and can be defined as “any variable whose value for a given individual does not change over time”. Moreover, two important properties of the Cox proportional hazards model regression model formula are that firstly when all the <span class="math inline">\(X^{\prime} s\)</span> are zero then the formula equals the baseline hazard function as an exponential raised to the zero equals one, and the exponential in the Cox formula ensures that the fitted hazard is not negative.
<br/><br/>
Secondly, the Cox model is semi-parametric because <span class="math inline">\(\mathit{{h_{0}(t)}}\)</span> the baseline hazard function is unspecified, whereas , parametric models such as the Weibull or Exponential have a fixed functional form, so the Cox model is appropriate in many data situations where functional form of the baseline hazard is unknown as it can often accurately approximate the correct parametric form.
<br/><br/>
The estimates of the <span class="math inline">\(\beta^{\prime} \mathrm{s}\)</span> (parameters) in the Cox model: <span class="math inline">\(h(t, \mathbf{X})=h_{0}(t) e^{\sum_{i=1}^{p} \beta_{i} X_{i}}\)</span> are computed using a maximum likelihood approach to give the ML estimates <span class="math inline">\(\hat{\beta}_{i}\)</span>.
<br/><br/>
Another important concept is the hazard ratio. This ratio allows comparison of two individuals that are differentiated by their predictor set (<span class="math inline">\(X^{\prime} s\)</span>). Computing the hazard ratio as follows:</p>
<p><br/><br/></p>
<p><span class="math display">\[\widehat{H R}=\frac{\hat{h}\left(t, \mathbf{X}^{*}\right)}{\hat{h}(t, \mathbf{X})}\]</span></p>
<p><br/><br/></p>
<p><span class="math display">\[\mathbf{X}=\left(X_{1}, X_{2}, \ldots, X_{p}\right)\]</span></p>
<p><br/><br/></p>
<p>The hazard ratio is the division of <span class="math inline">\(h\left(t, \mathbf{X}^{*}\right)\)</span> by <span class="math inline">\(h(t, \mathbf{X})\)</span>. Noting that the individual with the greater hazard is in the numerator (usually the placebo group) so that the hazard ratio is a value greater than one and <span class="math inline">\(\hat{h}\left(t, \mathbf{X}^{*}\right) \geq \hat{h}(t, \mathbf{X})\)</span>, which aids in interpretability.</p>
<p><br/><br/></p>
<p><span class="math display">\[\widehat{H R}=\frac{\hat{h}_{0}(t) e^{\sum_{e=1}^{p} \hat{\beta}_{i} X_{i}^{*}}}{\hat{h}_{0}(t) e^{\sum_{e^{i=1}}^{p} \hat{\beta}_{i} X_{i}}}=e^{\sum_{i=1}^{p} \hat{\beta}_{i}\left(X_{i}^{*}-X_{i}\right)}\]</span></p>
<p><br/><br/></p>
<p>To arrive at the final formula in (4): Substitute the Cox model formula into the hazard ratio for the respective <span class="math inline">\(\mathbf{X}^{*}\)</span> and <span class="math inline">\(\mathbf{X}\)</span> values to express it in terms of the regression coefficients. Noting that the expression does not depend on <span class="math inline">\(\textit{t}\)</span>.</p>
<p><br/><br/></p>
<p>The proportional hazards assumption meaning can now be explained, using the hazard ratio.</p>
<p><br/><br/></p>
<p><span class="math display">\[\hat{h}\left(t, X^{*}\right)=\hat{\theta} \hat{h}(t, X)\]</span></p>
<p><br/><br/></p>
<p>By letting <span class="math inline">\(\hat{\theta}\)</span> equal to <span class="math inline">\(\exp \left[\sum_{i=1}^{p} \hat{\beta}_{i}\left(X_{i}^{*}-X_{i}\right)\right]\)</span> it follows that <span class="math inline">\(\frac{\hat{h}\left(t, \mathbf{X}^{*}\right)}{\hat{h}(t, \mathbf{X})}=\hat{\theta}\)</span> and so <span class="math inline">\(\hat{h}\left(t, X^{*}\right)=\hat{\theta} \hat{h}(t, X)\)</span> where the constant of proportionality <span class="math inline">\(\hat{\theta}\)</span> is not dependent on <span class="math inline">\(\textit{t}\)</span>. Therefore, one subjects hazard function is in proportion to another subjects hazard.
</p>

<!--
This is for including Chapter 1.  Notice that it's also good practice to name your chunk.  This will help you debug potential issues as you knit.  The chunk above is called intro and the one below is called chapter1.  Feel free to change the name of the Rmd file as you wish, but don't forget to change it here from chap1.Rmd.
-->
<!--
The {#rmd-basics} text after the chapter declaration will allow us to link throughout the document back to the beginning of Chapter 1.  These labels will automatically be generated (if not specified) by changing the spaces to hyphens and capital letters to lowercase.  Look for the reference to this label at the beginning of Chapter 2.
-->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="1-section-rmd-basics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
